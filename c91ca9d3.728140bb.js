/*! For license information please see c91ca9d3.728140bb.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{103:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),l=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):A(A({},t),e)),n},u=function(e){var t=l(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=a,p=u["".concat(i,".").concat(m)]||u[m]||d[m]||o;return n?r.a.createElement(p,A(A({ref:t},c),{},{components:n})):r.a.createElement(p,A({ref:t},c))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var A={};for(var s in t)hasOwnProperty.call(t,s)&&(A[s]=t[s]);A.originalType=e,A.mdxType="string"==typeof e?e:a,i[1]=A;for(var c=2;c<o;c++)i[c]=n[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},104:function(e,t,n){"use strict";e.exports=n(105)},105:function(e,t,n){"use strict";var a=n(106),r="function"==typeof Symbol&&Symbol.for,o=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,A=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.forward_ref"):60112,m=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.memo"):60115,b=r?Symbol.for("react.lazy"):60116,h="function"==typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function j(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}function O(){}function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}j.prototype.isReactComponent={},j.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},j.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},O.prototype=j.prototype;var w=v.prototype=new O;w.constructor=v,a(w,j.prototype),w.isPureReactComponent=!0;var N={current:null},R=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var a,r={},i=null,A=null;if(null!=t)for(a in void 0!==t.ref&&(A=t.ref),void 0!==t.key&&(i=""+t.key),t)R.call(t,a)&&!S.hasOwnProperty(a)&&(r[a]=t[a]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];r.children=c}if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===r[a]&&(r[a]=s[a]);return{$$typeof:o,type:e,key:i,ref:A,props:r,_owner:N.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var T=/\/+/g,I=[];function C(e,t,n,a){if(I.length){var r=I.pop();return r.result=e,r.keyPrefix=t,r.func=n,r.context=a,r.count=0,r}return{result:e,keyPrefix:t,func:n,context:a,count:0}}function P(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>I.length&&I.push(e)}function D(e,t,n,a){var r=typeof e;"undefined"!==r&&"boolean"!==r||(e=null);var A=!1;if(null===e)A=!0;else switch(r){case"string":case"number":A=!0;break;case"object":switch(e.$$typeof){case o:case i:A=!0}}if(A)return n(a,e,""===t?"."+M(e,0):t),1;if(A=0,t=""===t?".":t+":",Array.isArray(e))for(var s=0;s<e.length;s++){var c=t+M(r=e[s],s);A+=D(r,c,n,a)}else if(null===e||"object"!=typeof e?c=null:c="function"==typeof(c=h&&e[h]||e["@@iterator"])?c:null,"function"==typeof c)for(e=c.call(e),s=0;!(r=e.next()).done;)A+=D(r=r.value,c=t+M(r,s++),n,a);else if("object"===r)throw n=""+e,Error(f(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return A}function E(e,t,n){return null==e?0:D(e,"",t,n)}function M(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function z(e,t){e.func.call(e.context,t,e.count++)}function U(e,t,n){var a=e.result,r=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?H(e,a,n,(function(e){return e})):null!=e&&(x(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,r+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(T,"$&/")+"/")+n)),a.push(e))}function H(e,t,n,a,r){var o="";null!=n&&(o=(""+n).replace(T,"$&/")+"/"),E(e,U,t=C(t,o,a,r)),P(t)}var Z={current:null};function F(){var e=Z.current;if(null===e)throw Error(f(321));return e}var V={ReactCurrentDispatcher:Z,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:N,IsSomeRendererActing:{current:!1},assign:a};t.Children={map:function(e,t,n){if(null==e)return e;var a=[];return H(e,a,null,t,n),a},forEach:function(e,t,n){if(null==e)return e;E(e,z,t=C(null,null,t,n)),P(t)},count:function(e){return E(e,(function(){return null}),null)},toArray:function(e){var t=[];return H(e,t,null,(function(e){return e})),t},only:function(e){if(!x(e))throw Error(f(143));return e}},t.Component=j,t.Fragment=A,t.Profiler=c,t.PureComponent=v,t.StrictMode=s,t.Suspense=m,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,t.cloneElement=function(e,t,n){if(null==e)throw Error(f(267,e));var r=a({},e.props),i=e.key,A=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(A=t.ref,s=N.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)R.call(t,l)&&!S.hasOwnProperty(l)&&(r[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)r.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:o,type:e.type,key:i,ref:A,props:r,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:u,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:b,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return F().useCallback(e,t)},t.useContext=function(e,t){return F().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return F().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return F().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},t.useMemo=function(e,t){return F().useMemo(e,t)},t.useReducer=function(e,t,n){return F().useReducer(e,t,n)},t.useRef=function(e){return F().useRef(e)},t.useState=function(e){return F().useState(e)},t.version="16.14.0"},106:function(e,t,n){"use strict";var a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(r){return!1}}()?Object.assign:function(e,t){for(var n,A,s=i(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))r.call(n,l)&&(s[l]=n[l]);if(a){A=a(n);for(var u=0;u<A.length;u++)o.call(n,A[u])&&(s[A[u]]=n[A[u]])}}return s}},178:function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,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"},179:function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,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"},95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return A})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return l}));var a=n(3),r=n(7),o=(n(104),n(103)),i={id:"immer-reducers",title:"Writing Reducers with Immer",sidebar_label:"Writing Reducers with Immer",hide_title:!0},A={unversionedId:"usage/immer-reducers",id:"usage/immer-reducers",isDocsHomePage:!1,title:"Writing Reducers with Immer",description:"Writing Reducers with Immer",source:"@site/../docs/usage/immer-reducers.md",slug:"/usage/immer-reducers",permalink:"/usage/immer-reducers",version:"current",sidebar_label:"Writing Reducers with Immer",sidebar:"docs",previous:{title:"Usage With TypeScript",permalink:"/usage/usage-with-typescript"},next:{title:"configureStore",permalink:"/api/configureStore"}},s=[{value:"Immutability and Redux",id:"immutability-and-redux",children:[{value:"Basics of Immutability",id:"basics-of-immutability",children:[]},{value:"Reducers and Immutable Updates",id:"reducers-and-immutable-updates",children:[]}]},{value:"Immutable Updates with Immer",id:"immutable-updates-with-immer",children:[{value:"Redux Toolkit and Immer",id:"redux-toolkit-and-immer",children:[]}]},{value:"Immer Usage Patterns",id:"immer-usage-patterns",children:[{value:"Mutating and Returning State",id:"mutating-and-returning-state",children:[]},{value:"Resetting and Replacing State",id:"resetting-and-replacing-state",children:[]},{value:"Debugging and Inspecting Drafted State",id:"debugging-and-inspecting-drafted-state",children:[]},{value:"Updating Nested Data",id:"updating-nested-data",children:[]},{value:"Linting State Mutations",id:"linting-state-mutations",children:[]}]},{value:"Further Information",id:"further-information",children:[]}],c={toc:s};function l(e){var t=e.components,i=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h1",{id:"writing-reducers-with-immer"},"Writing Reducers with Immer"),Object(o.b)("p",null,"Redux Toolkit's ",Object(o.b)("a",{parentName:"p",href:"/api/createReducer"},Object(o.b)("inlineCode",{parentName:"a"},"createReducer"))," and ",Object(o.b)("a",{parentName:"p",href:"/api/createSlice"},Object(o.b)("inlineCode",{parentName:"a"},"createSlice"))," automatically use ",Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/"},"Immer"),' internally to let you write simpler immutable update logic using "mutating" syntax. This helps simplify most reducer implementations.'),Object(o.b)("p",null,"Because Immer is itself an abstraction layer, it's important to understand why Redux Toolkit uses Immer, and how to use it correctly."),Object(o.b)("h2",{id:"immutability-and-redux"},"Immutability and Redux"),Object(o.b)("h3",{id:"basics-of-immutability"},"Basics of Immutability"),Object(o.b)("p",null,'"Mutable" means "changeable". If something is "immutable", it can never be changed.'),Object(o.b)("p",null,"JavaScript objects and arrays are all mutable by default. If I create an object, I can change the contents of its fields. If I create an array, I can change the contents as well:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const obj = { a: 1, b: 2 }\n// still the same object outside, but the contents have changed\nobj.b = 3\n\nconst arr = ['a', 'b']\n// In the same way, we can change the contents of this array\narr.push('c')\narr[1] = 'd'\n")),Object(o.b)("p",null,"This is called ",Object(o.b)("em",{parentName:"p"},"mutating")," the object or array. It's the same object or array reference in memory, but now the contents inside the object have changed."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"In order to update values immutably, your code must make ",Object(o.b)("em",{parentName:"strong"},"copies")," of existing objects/arrays, and then modify the copies"),"."),Object(o.b)("p",null,"We can do this by hand using JavaScript's array / object spread operators, as well as array methods that return new copies of the array instead of mutating the original array:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const obj = {\n  a: {\n    // To safely update obj.a.c, we have to copy each piece\n    c: 3,\n  },\n  b: 2,\n}\n\nconst obj2 = {\n  // copy obj\n  ...obj,\n  // overwrite a\n  a: {\n    // copy obj.a\n    ...obj.a,\n    // overwrite c\n    c: 42,\n  },\n}\n\nconst arr = ['a', 'b']\n// Create a new copy of arr, with \"c\" appended to the end\nconst arr2 = arr.concat('c')\n\n// or, we can make a copy of the original array:\nconst arr3 = arr.slice()\n// and mutate the copy:\narr3.push('c')\n")),Object(o.b)("div",{className:"admonition admonition-info alert alert--info"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Want to Know More?")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"For more info on how immutability works in JavaScript, see:"),Object(o.b)("ul",{parentName:"div"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://daveceddia.com/javascript-references/"},"A Visual Guide to References in JavaScript")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://daveceddia.com/react-redux-immutability-guide/"},"Immutability in React and Redux: The Complete Guide"))))),Object(o.b)("h3",{id:"reducers-and-immutable-updates"},"Reducers and Immutable Updates"),Object(o.b)("p",null,"One of the primary rules of Redux is that ",Object(o.b)("strong",{parentName:"p"},"our reducers are ",Object(o.b)("em",{parentName:"strong"},"never")," allowed to mutate the original / current state values!")),Object(o.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("pre",{parentName:"div"},Object(o.b)("code",{parentName:"pre",className:"language-js"},"// \u274c Illegal - by default, this will mutate the state!\nstate.value = 123\n")))),Object(o.b)("p",null,"There are several reasons why you must not mutate state in Redux:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"It causes bugs, such as the UI not updating properly to show the latest values"),Object(o.b)("li",{parentName:"ul"},"It makes it harder to understand why and how the state has been updated"),Object(o.b)("li",{parentName:"ul"},"It makes it harder to write tests"),Object(o.b)("li",{parentName:"ul"},'It breaks the ability to use "time-travel debugging" correctly'),Object(o.b)("li",{parentName:"ul"},"It goes against the intended spirit and usage patterns for Redux")),Object(o.b)("p",null,"So if we can't change the originals, how do we return an updated state?"),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},Object(o.b)("strong",{parentName:"p"},"Reducers can only make ",Object(o.b)("em",{parentName:"strong"},"copies")," of the original values, and then they can mutate the copies.")),Object(o.b)("pre",{parentName:"div"},Object(o.b)("code",{parentName:"pre",className:"language-js"},"// \u2705 This is safe, because we made a copy\nreturn {\n  ...state,\n  value: 123,\n}\n")))),Object(o.b)("p",null,"We already saw that we can write immutable updates by hand, by using JavaScript's array / object spread operators and other functions that return copies of the original values."),Object(o.b)("p",null,"This becomes harder when the data is nested. ",Object(o.b)("strong",{parentName:"p"},"A critical rule of immutable updates is that you must make a copy of ",Object(o.b)("em",{parentName:"strong"},"every")," level of nesting that needs to be updated.")),Object(o.b)("p",null,"A typical example of this might look like:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"function handwrittenReducer(state, action) {\n  return {\n    ...state,\n    first: {\n      ...state.first,\n      second: {\n        ...state.first.second,\n        [action.someId]: {\n          ...state.first.second[action.someId],\n          fourth: action.someValue,\n        },\n      },\n    },\n  }\n}\n")),Object(o.b)("p",null,"However, if you're thinking that \"writing immutable updates by hand this way looks hard to remember and do correctly\"... yeah, you're right! :)"),Object(o.b)("p",null,"Writing immutable update logic by hand ",Object(o.b)("em",{parentName:"p"},"is")," hard, and ",Object(o.b)("strong",{parentName:"p"},"accidentally mutating state in reducers is the single most common mistake Redux users make"),"."),Object(o.b)("h2",{id:"immutable-updates-with-immer"},"Immutable Updates with Immer"),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/"},"Immer")," is a library that simplifies the process of writing immutable update logic."),Object(o.b)("p",null,"Immer provides a function called ",Object(o.b)("inlineCode",{parentName:"p"},"produce"),", which accepts two arguments: your original ",Object(o.b)("inlineCode",{parentName:"p"},"state"),', and a callback function. The callback function is given a "draft" version of that state, and inside the callback, it is safe to write code that mutates the draft value. Immer tracks all attempts to mutate the draft value and then replays those mutations using their immutable equivalents to create a safe, immutably updated result:'),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"import produce from 'immer'\n\nconst baseState = [\n  {\n    todo: 'Learn typescript',\n    done: true,\n  },\n  {\n    todo: 'Try immer',\n    done: false,\n  },\n]\n\nconst nextState = produce(baseState, (draftState) => {\n  // \"mutate\" the draft array\n  draftState.push({ todo: 'Tweet about it' })\n  // \"mutate\" the nested state\n  draftState[1].done = true\n})\n\nconsole.log(baseState === nextState)\n// false - the array was copied\nconsole.log(baseState[0] === nextState[0])\n// true - the first item was unchanged, so same reference\nconsole.log(baseState[1] === nextState[1])\n// false - the second item was copied and updated\n")),Object(o.b)("h3",{id:"redux-toolkit-and-immer"},"Redux Toolkit and Immer"),Object(o.b)("p",null,"Redux Toolkit's ",Object(o.b)("a",{parentName:"p",href:"/api/createReducer"},Object(o.b)("inlineCode",{parentName:"a"},"createReducer")," API"),' uses Immer internally automatically. So, it\'s already safe to "mutate" state inside of any case reducer function that is passed to ',Object(o.b)("inlineCode",{parentName:"p"},"createReducer"),":"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosReducer = createReducer([], (builder) => {\n  builder.addCase('todos/todoAdded', (state, action) => {\n    // \"mutate\" the array by calling push()\n    state.push(action.payload)\n  })\n})\n")),Object(o.b)("p",null,"In turn, ",Object(o.b)("inlineCode",{parentName:"p"},"createSlice")," uses ",Object(o.b)("inlineCode",{parentName:"p"},"createReducer"),' inside, so it\'s also safe to "mutate" state there as well:'),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosSlice = createSlice({\n  name: 'todos',\n  initialState: [],\n  reducers: {\n    todoAdded(state, action) {\n      state.push(action.payload)\n    },\n  },\n})\n")),Object(o.b)("p",null,"This even applies if the case reducer functions are defined outside of the ",Object(o.b)("inlineCode",{parentName:"p"},"createSlice/createReducer"),' call. For example, you could have a reusable case reducer function that expects to "mutate" its state, and include it as needed:'),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const addItemToArray = (state, action) => {\n  state.push(action.payload)\n}\n\nconst todosSlice = createSlice({\n  name: 'todos',\n  initialState: [],\n  reducers: {\n    todoAdded: addItemToArray,\n  },\n})\n")),Object(o.b)("p",null,'This works because the "mutating" logic is wrapped in Immer\'s ',Object(o.b)("inlineCode",{parentName:"p"},"produce")," method internally when it executes."),Object(o.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"Remember, ",Object(o.b)("strong",{parentName:"p"},'the "mutating" logic ',Object(o.b)("em",{parentName:"strong"},"only")," works correctly when wrapped inside of Immer!")," Otherwise, that code ",Object(o.b)("em",{parentName:"p"},"will")," really mutate the data."))),Object(o.b)("h2",{id:"immer-usage-patterns"},"Immer Usage Patterns"),Object(o.b)("p",null,"There are several useful patterns to know about and gotchas to watch out for when using Immer in Redux Toolkit."),Object(o.b)("h3",{id:"mutating-and-returning-state"},"Mutating and Returning State"),Object(o.b)("p",null,"Immer works by tracking attempts to mutate an existing drafted state value, either by assigning to nested fields or by calling functions that mutate the value. That means that ",Object(o.b)("strong",{parentName:"p"},"the ",Object(o.b)("inlineCode",{parentName:"strong"},"state")," must be a JS object or array in order for Immer to see the attempted changes"),". (You can still have a slice's state be a primitive like a string or a boolean, but since primitives can never be mutated anyway, all you can do is just return a new value.)"),Object(o.b)("p",null,"In any given case reducer, ",Object(o.b)("strong",{parentName:"p"},"Immer expects that you will either ",Object(o.b)("em",{parentName:"strong"},"mutate")," the existing state, ",Object(o.b)("em",{parentName:"strong"},"or")," construct a new state value yourself and return it, but ",Object(o.b)("em",{parentName:"strong"},"not")," both in the same function!")," For example, both of these are valid reducers with Immer:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosSlice = createSlice({\n  name: 'todos',\n  initialState: [],\n  reducers: {\n    todoAdded(state, action) {\n      // \"Mutate\" the existing state, no return value needed\n      state.push(action.payload)\n    },\n    todoDeleted(state, action.payload) {\n      // Construct a new result array immutably and return it\n      return state.filter(todo => todo.id !== action.payload)\n    }\n  }\n})\n")),Object(o.b)("p",null,"However, it ",Object(o.b)("em",{parentName:"p"},"is"),' possible to use immutable updates to do part of the work and then save the results via a "mutation". An example of this might be filtering a nested array:'),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosSlice = createSlice({\n  name: 'todos',\n  initialState: {todos: [], status: 'idle'}\n  reducers: {\n    todoDeleted(state, action.payload) {\n      // Construct a new array immutably\n      const newTodos = state.todos.filter(todo => todo.id !== action.payload)\n      // \"Mutate\" the existing state to save the new array\n      state.todos = newTodos\n    }\n  }\n})\n")),Object(o.b)("p",null,"Note that ",Object(o.b)("strong",{parentName:"p"},"mutating state in an arrow function with an implicit return breaks this rule and causes an error!")," This is because statements and function calls may return a value, and Immer sees both the attempted mutation and ",Object(o.b)("em",{parentName:"p"},"and")," the new returned value and doesn't know which to use as the result. Some potential solutions are using the ",Object(o.b)("inlineCode",{parentName:"p"},"void")," keyword to skip having a return value, or using curly braces to give the arrow function a body and no return value:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosSlice = createSlice({\n  name: 'todos',\n  initialState: [],\n  reducers: {\n    // \u274c ERROR: mutates state, but also returns new array size!\n    brokenReducer: (state, action) => state.push(action.payload),\n    // \u2705 SAFE: the `void` keyword prevents a return value\n    fixedReducer1: (state, action) => void state.push(action.payload),\n    // \u2705 SAFE: curly braces make this a function body and no return\n    fixedReducer2: (state, action) => {\n      state.push(action.payload)\n    },\n  },\n})\n")),Object(o.b)("p",null,"While writing nested immutable update logic is hard, there are times when it ",Object(o.b)("em",{parentName:"p"},"is")," simpler to do an object spread operation to update multiple fields at once, vs assigning individual fields:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"function objectCaseReducer1(state, action) {\n  const { a, b, c, d } = action.payload\n  return {\n    ...state,\n    a,\n    b,\n    c,\n    d,\n  }\n}\n\nfunction objectCaseReducer2(state, action) {\n  const { a, b, c, d } = action.payload\n  // This works, but we keep having to repeat `state.x =`\n  state.a = a\n  state.b = b\n  state.c = c\n  state.d = d\n}\n")),Object(o.b)("p",null,"As an alternative, you can use ",Object(o.b)("inlineCode",{parentName:"p"},"Object.assign")," to mutate multiple fields at once, since ",Object(o.b)("inlineCode",{parentName:"p"},"Object.assign")," always mutates the first object that it's given:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"function objectCaseReducer3(state, action) {\n  const { a, b, c, d } = action.payload\n  Object.assign(state, { a, b, c, d })\n}\n")),Object(o.b)("h3",{id:"resetting-and-replacing-state"},"Resetting and Replacing State"),Object(o.b)("p",null,"Sometimes you may want to replace the entire existing ",Object(o.b)("inlineCode",{parentName:"p"},"state"),", either because you've loaded some new data, or you want to reset the state back to its initial value."),Object(o.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},Object(o.b)("strong",{parentName:"p"},"A common mistake is to try assigning ",Object(o.b)("inlineCode",{parentName:"strong"},"state = someValue")," directly. This will not work!")," This only points the local ",Object(o.b)("inlineCode",{parentName:"p"},"state")," variable to a different reference. That is neither mutating the existing ",Object(o.b)("inlineCode",{parentName:"p"},"state")," object/array in memory, nor returning an entirely new value, so Immer does not make any actual changes."))),Object(o.b)("p",null,"Instead, to replace the existing state, you should return the new value directly:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const initialState = []\nconst todosSlice = createSlice({\n  name: 'todos',\n  initialState,\n  reducers: {\n    brokenTodosLoadedReducer(state, action) {\n      // \u274c ERROR: does not actually mutate or return anything new!\n      state = action.payload\n    },\n    fixedTodosLoadedReducer(state, action) {\n      // \u2705 CORRECT: returns a new value to replace the old one\n      return action.payload\n    },\n    correctResetTodosReducer(state, action) {\n      // \u2705 CORRECT: returns a new value to replace the old one\n      return initialState\n    },\n  },\n})\n")),Object(o.b)("h3",{id:"debugging-and-inspecting-drafted-state"},"Debugging and Inspecting Drafted State"),Object(o.b)("p",null,"It's common to want to log in-progress state from a reducer to see what it looks like as it's being updated, like ",Object(o.b)("inlineCode",{parentName:"p"},"console.log(state)"),". Unfortunately, browsers display logged Proxy instances in a format that is hard to read or understand:"),Object(o.b)("p",null,Object(o.b)("img",{alt:"Logged proxy draft",src:n(178).default})),Object(o.b)("p",null,"To work around this, ",Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/current"},"Immer includes a ",Object(o.b)("inlineCode",{parentName:"a"},"current")," function that extracts a copy of the wrapped data"),", and RTK re-exports ",Object(o.b)("inlineCode",{parentName:"p"},"current"),". You can use this in your reducers if you need to log or inspect the work-in-progress state:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"import { current } from '@reduxjs/toolkit'\n\nconst todosSlice = createSlice({\n  name: 'todos',\n  initialState: todosAdapter.getInitialState(),\n  reducers: {\n    todoToggled(state, action) {\n      // \u274c ERROR: logs the Proxy-wrapped data\n      console.log(state)\n      // \u2705 CORRECT: logs a plain JS copy of the current data\n      console.log(current(state))\n    },\n  },\n})\n")),Object(o.b)("p",null,"The correct output would look like this instead:"),Object(o.b)("p",null,Object(o.b)("img",{alt:"Logged current value",src:n(179).default})),Object(o.b)("p",null,"Immer also provides ",Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/original"},Object(o.b)("inlineCode",{parentName:"a"},"original")," and ",Object(o.b)("inlineCode",{parentName:"a"},"isDraft")," functions"),", which retrieves the original data without any updates applied and check to see if a given value is a Proxy-wrapped draft. As of RTK 1.5.1, both of those are re-exported from RTK as well."),Object(o.b)("h3",{id:"updating-nested-data"},"Updating Nested Data"),Object(o.b)("p",null,"Immer greatly simplifies updating nested data. Nested objects and arrays are also wrapped in Proxies and drafted, and it's safe to pull out a nested value into its own variable and then mutate it."),Object(o.b)("p",null,"However, this still only applies to objects and arrays. If we pull out a primitive value into its own variable and try to update it, Immer has nothing to wrap and cannot track any updates:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const todosSlice = createSlice({\n  name: 'todos',\n  initialState: [],\n  reducers: {\n    brokenTodoToggled(state, action) {\n      const todo = state.find((todo) => todo.id === action.payload)\n      if (todo) {\n        // \u274c ERROR: Immer can't track updates to a primitive value!\n        let { completed } = todo\n        completed = !completed\n      }\n    },\n    fixedTodoToggled(state, action) {\n      const todo = state.find((todo) => todo.id === action.payload)\n      if (todo) {\n        // \u2705 CORRECT: This object is still wrapped in a Proxy, so we can \"mutate\" it\n        todo.completed = !todo.completed\n      }\n    },\n  },\n})\n")),Object(o.b)("p",null,"There ",Object(o.b)("em",{parentName:"p"},"is")," a gotcha here. ",Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/pitfalls#data-not-originating-from-the-state-will-never-be-drafted"},"Immer will not wrap objects that are newly inserted into the state"),". Most of the time this shouldn't matter, but there may be occasions when you want to insert a value and then make further updates to it."),Object(o.b)("p",null,"Related to this, RTK's ",Object(o.b)("a",{parentName:"p",href:"/api/createEntityAdapter#crud-functions"},Object(o.b)("inlineCode",{parentName:"a"},"createEntityAdapter")," update functions"),' can either be used as standalone reducers, or "mutating" update functions. These functions determine whether to "mutate" or return a new value by checking to see if the state they\'re given is wrapped in a draft or not. If you are calling these functions yourself inside of a case reducer, be sure you know whether you\'re passing them a draft value or a plain value.'),Object(o.b)("p",null,"Finally, it's worth noting that ",Object(o.b)("strong",{parentName:"p"},"Immer does not automatically create nested objects or arrays for you - you have to create them yourself"),". As an example, say we have a lookup table containing nested arrays, and we want to insert an item into one of those arrays. If we unconditionally try to insert without checking for the existence of that array, the logic will crash when the array doesn't exist. Instead, you'd need to ensure the array exists first:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const itemsSlice = createSlice({\n  name: 'items',\n  initialState: { a: [], b: [] },\n  reducers: {\n    brokenNestedItemAdded(state, action) {\n      const { id, item } = action.payload\n      // \u274c ERROR: will crash if no array exists for `id`!\n      state[id].push(item)\n    },\n    fixedNestedItemAdded(state, action) {\n      const { id, item } = action.payload\n      // \u2705 CORRECT: ensures the nested array always exists first\n      if (!state[id]) {\n        state[id] = []\n      }\n\n      state[id].push(item)\n    },\n  },\n})\n")),Object(o.b)("h3",{id:"linting-state-mutations"},"Linting State Mutations"),Object(o.b)("p",null,"Many ESLint configs include the ",Object(o.b)("a",{parentName:"p",href:"https://eslint.org/docs/rules/no-param-reassign"},"https://eslint.org/docs/rules/no-param-reassign")," rule, which may also warn about mutations to nested fields. That can cause the rule to warn about mutations to ",Object(o.b)("inlineCode",{parentName:"p"},"state")," in Immer-powered reducers, which is not helpful."),Object(o.b)("p",null,"To resolve this, you can tell the ESLint rule to ignore mutations to a parameter named ",Object(o.b)("inlineCode",{parentName:"p"},"state"),":"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"{\n  'no-param-reassign': ['error', { props: true, ignorePropertyModificationsFor: ['state'] }]\n}\n\n")),Object(o.b)("h2",{id:"further-information"},"Further Information"),Object(o.b)("p",null,"See ",Object(o.b)("a",{parentName:"p",href:"https://immerjs.github.io/immer/"},"the Immer documentation")," for more details on Immer's APIs, edge cases, and behavior."))}l.isMDXComponent=!0}}]);